# Проект: Обработка студентов и координат

Проект состоит из двух независимых задач, реализованных на C++ с использованием Qt.

## Содержание
- [Требования](#требования)
- [Сборка](#сборка)
- [Задача 1: ZeroMQ сервис студентов](#задача-1-zeromq-сервис-студентов)
- [Задача 2: HTTP сервис координат](#задача-2-http-сервис-координат)

## Требования

### Системные требования
- CMake 3.16+
- Qt 5.15 или выше
- C++17 компилятор

### Установка зависимостей

```bash
# Обновление пакетов
sudo apt update

# Установка базовых инструментов разработки
sudo apt install build-essential cmake pkg-config

# Установка Qt
sudo apt install qtbase5-dev qt5-qmake qtchooser qttools5-dev-tools

# Установка ZeroMQ
sudo apt install libzmq3-dev

# Для HTTP сервера в задаче 2 (Qt 6+)
sudo apt install qt6-base-dev qt6-httpserver-dev
```

## Сборка

### Клонирование и настройка проекта

```bash
# Клонирование репозитория (замените на ваш репозиторий)
git clone https://github.com/koin32/NTC_Advanced_Systems_test_task.git
cd project

# Создание директории для сборки
mkdir build
cd build
```

### Сборка всех задач

```bash
cmake ..
make -j$(nproc)
```

### Сборка отдельных задач

```bash
# Только задача 1
cmake -DBUILD_TASK1=ON -DBUILD_TASK2=OFF ..
make task1_server task1_client

# Только задача 2
cmake -DBUILD_TASK1=OFF -DBUILD_TASK2=ON ..
make task2_server
```

## Задача 1: ZeroMQ сервис студентов

### Описание
Система передачи данных о студентах между сервером и клиентом с использованием ZeroMQ Pub-Sub паттерна.

### Структура
- **Сервер**: Читает данные из файлов, объединяет дубликаты, публикует данные
- **Клиент**: Подписывается на данные, сортирует и отображает студентов

### Подготовка данных

Создайте файлы с данными студентов:

**student_file_1.txt**
```
1 Ivan Ivanovich 01.01.1988
2 Petr Petrov 04.07.1988
3 Denis Denisov 43.01.1988
4 Vladimir Jukov 04.5.1987
5 Vladimir Kochkin 11.10.1989
```

**student_file_2.txt**
```
34 Ivan Ivanovich 01.01.1988
54 Petr Kazakov 05.07.1986
23 Denis Denisov 04.03.1988
12 Vladimir Jukov 04.5.1987
43 Vladimir Kochkin 11.11.1989
```

### Запуск сервера

```bash
# Из директории build
./task1/server/student_server --endpoint tcp://*:5555

# Или с параметрами по умолчанию
./task1/server/student_server
```

**Параметры сервера:**
- `-e, --endpoint` - ZMQ endpoint (по умолчанию: `tcp://*:5555`)
- `-h, --help` - справка

### Запуск клиента

```bash
# Из директории build
./task1/client/student_client --endpoint tcp://localhost:5555

# Или с параметрами по умолчанию
./task1/client/student_client
```

**Параметры клиента:**
- `-e, --endpoint` - ZMQ endpoint для подключения (по умолчанию: `tcp://localhost:5555`)
- `-h, --help` - справка

### Пример вывода клиента

```
Client started. Waiting for student data...

=== Received students list ===
Total students: 6
==============================
1: Ivan Ivanovich (01.01.1988)
2: Petr Petrov (04.07.1988)
3: Denis Denisov (04.03.1988)
4: Vladimir Jukov (04.05.1987)
5: Vladimir Kochkin (11.10.1989)
54: Petr Kazakov (05.07.1986)
==============================
```

### Особенности реализации

- **Многопоточность**: Сервер и клиент работают в отдельных потоках
- **Валидация**: Проверка корректности данных студентов
- **Объединение дубликатов**: Студенты с одинаковыми ФИО и датой рождения объединяются
- **Сортировка**: Клиент сортирует студентов по ФИО
- **Логирование**: Подробное логирование процесса работы

## Задача 2: HTTP сервис координат

### Описание
HTTP сервис для извлечения и анализа географических координат из текста. Сервис определяет формат координат, преобразует их в десятичные градусы и классифицирует геометрические фигуры.

### Поддерживаемые форматы координат

1. Десятичные градусы: `12.2112 -32.434`
2. С обозначениями полушарий: `N12.2112 W32.434`
3. Градусы-минуты: `34-24N 124-49W`
4. Компактный формат: `5401N 15531W`
5. Градусы с символами: `51°12.32'S 32°34.43'E`
6. С русскими обозначениями: `51°12.32' с.ш. 32°34.43' в.д.`
7. Градусы-минуты-секунды: `51°12'32.212''S 32°34'23.1232''E`
8. С разделителем запятой: `55,755831°, 37,617673°`

### Запуск сервера

```bash
# Из директории build
./task2/coordinate_server --port 8080 --host 0.0.0.0

# Или с параметрами по умолчанию
./task2/coordinate_server
```

**Параметры сервера:**
- `-p, --port` - порт сервера (по умолчанию: 8080)
- `-h, --host` - хост сервера (по умолчанию: 0.0.0.0)
- `--help` - справка

### Использование API

#### Эндпоинт: `POST /extract-coordinates`

**Запрос:**
```http
POST /extract-coordinates HTTP/1.1
Content-Type: application/json

{
    "text": "Текст с координатами: 55.7558° с.ш. 37.6173° в.д. и N40.7128 W74.0060"
}
```

**Ответ:**
```json
{
    "status": "success",
    "coordinates": [
        {
            "latitude": 55.7558,
            "longitude": 37.6173,
            "original_text": "55.7558° с.ш. 37.6173° в.д.",
            "context": "Текст с координатами: 55.7558° с.ш. 37.6173° в.д. и N40.7128 W74.0060",
            "name": "",
            "is_valid": true
        },
        {
            "latitude": 40.7128,
            "longitude": -74.0060,
            "original_text": "N40.7128 W74.0060",
            "context": "Текст с координатами: 55.7558° с.ш. 37.6173° в.д. и N40.7128 W74.0060",
            "name": "",
            "is_valid": true
        }
    ],
    "geometry_type": "points",
    "total_coordinates": 2,
    "valid_coordinates": 2
}
```

### Пример использования с curl

```bash
curl -X POST http://localhost:8080/extract-coordinates \
  -H "Content-Type: application/json" \
  -d '{
    "text": "Маршрут начинается в точке 55.7558° с.ш. 37.6173° в.д. (Москва) и продолжается до N40.7128 W74.0060 (Нью-Йорк). По пути зафиксированы координаты 48.8566, 2.3522."
  }'
```

### Классификация геометрических фигур

Сервис автоматически определяет тип геометрической фигуры:

- **points**: Одиночные точки (1-2 координаты)
- **line**: Линия (3+ координаты в последовательности)
- **polygon**: Замкнутый полигон (4+ координаты, первая и последняя близки)

### Особенности реализации

- **Регулярные выражения**: Поддержка множества форматов координат
- **Валидация**: Проверка диапазонов широты (-90 до 90) и долготы (-180 до 180)
- **Контекст**: Извлечение предложения с координатой (до 200 символов)
- **Названия**: Автоматическое определение названий точек
- **Многопоточность**: Асинхронная обработка запросов
- **Логирование**: Детальное логирование процесса обработки

## Структура проекта

```
NTC_Advanced_Systems_test_task/
├── CMakeLists.txt
├── task1/
│   ├── CMakeLists.txt
│   ├── server/
│   │   ├── main.cpp
│   │   ├── Student.h/cpp
│   │   ├── StudentParser.h/cpp
│   │   ├── StudentManager.h/cpp
│   │   └── ZmqServer.h/cpp
│   └── client/
│       ├── main.cpp
│       ├── Student.h/cpp
│       └── ZmqClient.h/cpp
└── task2/
    ├── CMakeLists.txt
    ├── main.cpp
    ├── CoordinateParser.h/cpp
    ├── CoordinateService.h/cpp
    ├── HttpServer.h/cpp
    └── test_data/
        ├── text1.txt
        └── text2.txt
```

## Решение проблем

### Ошибки сборки

**Проблема**: Не найдены заголовочные файлы Qt
```bash
sudo apt install qtbase5-dev
```

**Проблема**: Ошибки линковки с ZeroMQ
```bash
sudo apt install libzmq3-dev
```

**Проблема**: Не поддерживается Qt HttpServer
```bash
# Для Ubuntu 22.04+
sudo apt install qt6-httpserver-dev

# Или используйте альтернативное решение с Qt5
```

### Ошибки выполнения

**Проблема**: Сервер не запускается на порту
```bash
# Проверьте, не занят ли порт
sudo netstat -tulpn | grep :8080

# Используйте другой порт
./task2/coordinate_server --port 8081
```

**Проблема**: Клиент не подключается к серверу
```bash
# Проверьте firewall
sudo ufw status

# Проверьте правильность endpoint
./task1/client/student_client --endpoint tcp://192.168.1.100:5555
```

## Дополнительные возможности

### Тестирование

```bash
# Запуск тестовых сценариев
./test_task1.sh
./test_task2.sh
```

### Мониторинг

```bash
# Мониторинг сетевых соединений
sudo netstat -tulpn | grep -E '(5555|8080)'

# Просмотр логов в реальном времени
tail -f /var/log/syslog | grep student_server
```
